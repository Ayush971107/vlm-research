INFO:__main__:Parquet file data_main_html.parquet already exists, using it
INFO:__main__:Checkpoint loaded. Resuming from row 2350
INFO:__main__:Loading metadata from data_main_html.parquet...
INFO:__main__:Found 33886 HTML rows in Parquet file
INFO:__main__:Processing 31536 rows using multiprocessing
INFO:__main__:Using 6 CPU cores for parallel processing with chunk size 10
WARNING:__main__:Missing HTML content for row 2350
WARNING:__main__:Missing HTML content for row 2351
WARNING:__main__:Missing HTML content for row 2352
WARNING:__main__:Missing HTML content for row 2353
WARNING:__main__:Missing HTML content for row 2354
WARNING:__main__:Missing HTML content for row 2355
WARNING:__main__:Missing HTML content for row 2356
WARNING:__main__:Missing HTML content for row 2357
WARNING:__main__:Missing HTML content for row 2358
WARNING:__main__:Missing HTML content for row 2359
INFO:__main__:Progress: 10/31536 (0.0%)
WARNING:__main__:Missing HTML content for row 2400
WARNING:__main__:Missing HTML content for row 2401
WARNING:__main__:Missing HTML content for row 2402
WARNING:__main__:Missing HTML content for row 2403
WARNING:__main__:Missing HTML content for row 2404
WARNING:__main__:Missing HTML content for row 2405
WARNING:__main__:Missing HTML content for row 2406
WARNING:__main__:Missing HTML content for row 2407
WARNING:__main__:Missing HTML content for row 2408
WARNING:__main__:Missing HTML content for row 2409
INFO:__main__:Progress: 20/31536 (0.1%)
WARNING:__main__:Missing HTML content for row 2420
WARNING:__main__:Missing HTML content for row 2421
WARNING:__main__:Missing HTML content for row 2422
WARNING:__main__:Missing HTML content for row 2423
WARNING:__main__:Missing HTML content for row 2424
WARNING:__main__:Missing HTML content for row 2425
WARNING:__main__:Missing HTML content for row 2426
WARNING:__main__:Missing HTML content for row 2427
WARNING:__main__:Missing HTML content for row 2428
WARNING:__main__:Missing HTML content for row 2429
INFO:__main__:Progress: 30/31536 (0.1%)
WARNING:__main__:Missing HTML content for row 2430
WARNING:__main__:Missing HTML content for row 2431
WARNING:__main__:Missing HTML content for row 2432
WARNING:__main__:Missing HTML content for row 2433
WARNING:__main__:Missing HTML content for row 2434
WARNING:__main__:Missing HTML content for row 2435
WARNING:__main__:Missing HTML content for row 2436
WARNING:__main__:Missing HTML content for row 2437
WARNING:__main__:Missing HTML content for row 2438
WARNING:__main__:Missing HTML content for row 2439
INFO:__main__:Progress: 40/31536 (0.1%)
WARNING:__main__:Missing HTML content for row 2440
WARNING:__main__:Missing HTML content for row 2441
WARNING:__main__:Missing HTML content for row 2442
WARNING:__main__:Missing HTML content for row 2443
WARNING:__main__:Missing HTML content for row 2444
WARNING:__main__:Missing HTML content for row 2445
WARNING:__main__:Missing HTML content for row 2446
WARNING:__main__:Missing HTML content for row 2447
WARNING:__main__:Missing HTML content for row 2448
WARNING:__main__:Missing HTML content for row 2449
INFO:__main__:Progress: 50/31536 (0.2%)
INFO:__main__:Saving checkpoint at 50 rows processed
INFO:__main__:Checkpoint saved at row 2449
WARNING:__main__:Missing HTML content for row 2450
WARNING:__main__:Missing HTML content for row 2451
WARNING:__main__:Missing HTML content for row 2452
WARNING:__main__:Missing HTML content for row 2453
WARNING:__main__:Missing HTML content for row 2454
WARNING:__main__:Missing HTML content for row 2455
WARNING:__main__:Missing HTML content for row 2456
WARNING:__main__:Missing HTML content for row 2457
WARNING:__main__:Missing HTML content for row 2458
WARNING:__main__:Missing HTML content for row 2459
INFO:__main__:Progress: 60/31536 (0.2%)
WARNING:__main__:Missing HTML content for row 2460
WARNING:__main__:Missing HTML content for row 2461
WARNING:__main__:Missing HTML content for row 2462
WARNING:__main__:Missing HTML content for row 2463
WARNING:__main__:Missing HTML content for row 2464
WARNING:__main__:Missing HTML content for row 2465
WARNING:__main__:Missing HTML content for row 2466
WARNING:__main__:Missing HTML content for row 2467
WARNING:__main__:Missing HTML content for row 2468
WARNING:__main__:Missing HTML content for row 2469
INFO:__main__:Progress: 70/31536 (0.2%)
WARNING:__main__:Missing HTML content for row 2470
WARNING:__main__:Missing HTML content for row 2471
WARNING:__main__:Missing HTML content for row 2472
WARNING:__main__:Missing HTML content for row 2473
WARNING:__main__:Missing HTML content for row 2474
WARNING:__main__:Missing HTML content for row 2475
WARNING:__main__:Missing HTML content for row 2476
WARNING:__main__:Missing HTML content for row 2477
WARNING:__main__:Missing HTML content for row 2478
WARNING:__main__:Missing HTML content for row 2479
INFO:__main__:Progress: 80/31536 (0.3%)
WARNING:__main__:Missing HTML content for row 2480
WARNING:__main__:Missing HTML content for row 2481
WARNING:__main__:Missing HTML content for row 2482
WARNING:__main__:Missing HTML content for row 2483
WARNING:__main__:Missing HTML content for row 2484
WARNING:__main__:Missing HTML content for row 2485
WARNING:__main__:Missing HTML content for row 2486
WARNING:__main__:Missing HTML content for row 2487
WARNING:__main__:Missing HTML content for row 2488
WARNING:__main__:Missing HTML content for row 2489
INFO:__main__:Progress: 90/31536 (0.3%)
WARNING:__main__:Missing HTML content for row 2490
WARNING:__main__:Missing HTML content for row 2491
WARNING:__main__:Missing HTML content for row 2492
WARNING:__main__:Missing HTML content for row 2493
WARNING:__main__:Missing HTML content for row 2494
WARNING:__main__:Missing HTML content for row 2495
WARNING:__main__:Missing HTML content for row 2496
WARNING:__main__:Missing HTML content for row 2497
WARNING:__main__:Missing HTML content for row 2498
WARNING:__main__:Missing HTML content for row 2499
INFO:__main__:Progress: 100/31536 (0.3%)
INFO:__main__:Saving checkpoint at 100 rows processed
INFO:__main__:Checkpoint saved at row 2499
WARNING:__main__:Missing HTML content for row 2500
WARNING:__main__:Missing HTML content for row 2501
WARNING:__main__:Missing HTML content for row 2502
WARNING:__main__:Missing HTML content for row 2503
WARNING:__main__:Missing HTML content for row 2504
WARNING:__main__:Missing HTML content for row 2505
WARNING:__main__:Missing HTML content for row 2506
WARNING:__main__:Missing HTML content for row 2507
WARNING:__main__:Missing HTML content for row 2508
WARNING:__main__:Missing HTML content for row 2509
INFO:__main__:Progress: 110/31536 (0.3%)
WARNING:__main__:Missing HTML content for row 2510
WARNING:__main__:Missing HTML content for row 2511
WARNING:__main__:Missing HTML content for row 2512
WARNING:__main__:Missing HTML content for row 2513
WARNING:__main__:Missing HTML content for row 2514
WARNING:__main__:Missing HTML content for row 2515
WARNING:__main__:Missing HTML content for row 2516
WARNING:__main__:Missing HTML content for row 2517
WARNING:__main__:Missing HTML content for row 2518
WARNING:__main__:Missing HTML content for row 2519
INFO:__main__:Progress: 120/31536 (0.4%)
WARNING:__main__:Missing HTML content for row 2520
WARNING:__main__:Missing HTML content for row 2521
WARNING:__main__:Missing HTML content for row 2522
WARNING:__main__:Missing HTML content for row 2523
WARNING:__main__:Missing HTML content for row 2524
WARNING:__main__:Missing HTML content for row 2525
WARNING:__main__:Missing HTML content for row 2526
WARNING:__main__:Missing HTML content for row 2527
WARNING:__main__:Missing HTML content for row 2528
WARNING:__main__:Missing HTML content for row 2529
INFO:__main__:Progress: 130/31536 (0.4%)
WARNING:__main__:Missing HTML content for row 2530
WARNING:__main__:Missing HTML content for row 2531
WARNING:__main__:Missing HTML content for row 2532
WARNING:__main__:Missing HTML content for row 2533
WARNING:__main__:Missing HTML content for row 2534
WARNING:__main__:Missing HTML content for row 2535
WARNING:__main__:Missing HTML content for row 2536
WARNING:__main__:Missing HTML content for row 2537
WARNING:__main__:Missing HTML content for row 2538
WARNING:__main__:Missing HTML content for row 2539
INFO:__main__:Progress: 140/31536 (0.4%)
WARNING:__main__:Missing HTML content for row 2540
WARNING:__main__:Missing HTML content for row 2541
WARNING:__main__:Missing HTML content for row 2542
WARNING:__main__:Missing HTML content for row 2543
WARNING:__main__:Missing HTML content for row 2544
WARNING:__main__:Missing HTML content for row 2545
WARNING:__main__:Missing HTML content for row 2546
WARNING:__main__:Missing HTML content for row 2547
WARNING:__main__:Missing HTML content for row 2548
WARNING:__main__:Missing HTML content for row 2549
INFO:__main__:Progress: 150/31536 (0.5%)
INFO:__main__:Saving checkpoint at 150 rows processed
INFO:__main__:Checkpoint saved at row 2549
WARNING:__main__:Missing HTML content for row 2550
WARNING:__main__:Missing HTML content for row 2551
WARNING:__main__:Missing HTML content for row 2552
WARNING:__main__:Missing HTML content for row 2553
WARNING:__main__:Missing HTML content for row 2554
WARNING:__main__:Missing HTML content for row 2555
WARNING:__main__:Missing HTML content for row 2556
WARNING:__main__:Missing HTML content for row 2557
WARNING:__main__:Missing HTML content for row 2558
WARNING:__main__:Missing HTML content for row 2559
INFO:__main__:Progress: 160/31536 (0.5%)
WARNING:__main__:Missing HTML content for row 2560
WARNING:__main__:Missing HTML content for row 2561
WARNING:__main__:Missing HTML content for row 2562
WARNING:__main__:Missing HTML content for row 2563
WARNING:__main__:Missing HTML content for row 2564
WARNING:__main__:Missing HTML content for row 2565
WARNING:__main__:Missing HTML content for row 2566
WARNING:__main__:Missing HTML content for row 2567
WARNING:__main__:Missing HTML content for row 2568
WARNING:__main__:Missing HTML content for row 2569
INFO:__main__:Progress: 170/31536 (0.5%)
WARNING:__main__:Missing HTML content for row 2570
WARNING:__main__:Missing HTML content for row 2571
WARNING:__main__:Missing HTML content for row 2572
WARNING:__main__:Missing HTML content for row 2573
WARNING:__main__:Missing HTML content for row 2574
WARNING:__main__:Missing HTML content for row 2575
WARNING:__main__:Missing HTML content for row 2576
WARNING:__main__:Missing HTML content for row 2577
WARNING:__main__:Missing HTML content for row 2578
WARNING:__main__:Missing HTML content for row 2579
INFO:__main__:Progress: 180/31536 (0.6%)
WARNING:__main__:Missing HTML content for row 2580
WARNING:__main__:Missing HTML content for row 2581
WARNING:__main__:Missing HTML content for row 2582
WARNING:__main__:Missing HTML content for row 2583
WARNING:__main__:Missing HTML content for row 2584
WARNING:__main__:Missing HTML content for row 2585
WARNING:__main__:Missing HTML content for row 2586
WARNING:__main__:Missing HTML content for row 2587
WARNING:__main__:Missing HTML content for row 2588
WARNING:__main__:Missing HTML content for row 2589
INFO:__main__:Progress: 190/31536 (0.6%)
WARNING:__main__:Missing HTML content for row 2590
WARNING:__main__:Missing HTML content for row 2591
WARNING:__main__:Missing HTML content for row 2592
WARNING:__main__:Missing HTML content for row 2593
WARNING:__main__:Missing HTML content for row 2594
WARNING:__main__:Missing HTML content for row 2595
WARNING:__main__:Missing HTML content for row 2596
WARNING:__main__:Missing HTML content for row 2597
WARNING:__main__:Missing HTML content for row 2598
WARNING:__main__:Missing HTML content for row 2599
INFO:__main__:Progress: 200/31536 (0.6%)
INFO:__main__:Saving checkpoint at 200 rows processed
INFO:__main__:Checkpoint saved at row 2599
WARNING:__main__:Missing HTML content for row 2600
WARNING:__main__:Missing HTML content for row 2601
WARNING:__main__:Missing HTML content for row 2602
WARNING:__main__:Missing HTML content for row 2603
WARNING:__main__:Missing HTML content for row 2604
WARNING:__main__:Missing HTML content for row 2605
WARNING:__main__:Missing HTML content for row 2606
WARNING:__main__:Missing HTML content for row 2607
WARNING:__main__:Missing HTML content for row 2608
WARNING:__main__:Missing HTML content for row 2609
INFO:__main__:Progress: 210/31536 (0.7%)
WARNING:__main__:Missing HTML content for row 2610
WARNING:__main__:Missing HTML content for row 2611
WARNING:__main__:Missing HTML content for row 2612
WARNING:__main__:Missing HTML content for row 2613
WARNING:__main__:Missing HTML content for row 2614
WARNING:__main__:Missing HTML content for row 2615
WARNING:__main__:Missing HTML content for row 2616
WARNING:__main__:Missing HTML content for row 2617
WARNING:__main__:Missing HTML content for row 2618
WARNING:__main__:Missing HTML content for row 2619
INFO:__main__:Progress: 220/31536 (0.7%)
WARNING:__main__:Missing HTML content for row 2620
WARNING:__main__:Missing HTML content for row 2621
WARNING:__main__:Missing HTML content for row 2622
WARNING:__main__:Missing HTML content for row 2623
WARNING:__main__:Missing HTML content for row 2624
WARNING:__main__:Missing HTML content for row 2625
WARNING:__main__:Missing HTML content for row 2626
WARNING:__main__:Missing HTML content for row 2627
WARNING:__main__:Missing HTML content for row 2628
WARNING:__main__:Missing HTML content for row 2629
INFO:__main__:Progress: 230/31536 (0.7%)
WARNING:__main__:Missing HTML content for row 2630
WARNING:__main__:Missing HTML content for row 2631
WARNING:__main__:Missing HTML content for row 2632
WARNING:__main__:Missing HTML content for row 2633
WARNING:__main__:Missing HTML content for row 2634
WARNING:__main__:Missing HTML content for row 2635
WARNING:__main__:Missing HTML content for row 2636
WARNING:__main__:Missing HTML content for row 2637
WARNING:__main__:Missing HTML content for row 2638
WARNING:__main__:Missing HTML content for row 2639
INFO:__main__:Progress: 240/31536 (0.8%)
WARNING:__main__:Missing HTML content for row 2640
WARNING:__main__:Missing HTML content for row 2641
WARNING:__main__:Missing HTML content for row 2642
WARNING:__main__:Missing HTML content for row 2643
WARNING:__main__:Missing HTML content for row 2644
WARNING:__main__:Missing HTML content for row 2645
WARNING:__main__:Missing HTML content for row 2646
WARNING:__main__:Missing HTML content for row 2647
WARNING:__main__:Missing HTML content for row 2648
WARNING:__main__:Missing HTML content for row 2649
INFO:__main__:Progress: 250/31536 (0.8%)
INFO:__main__:Saving checkpoint at 250 rows processed
INFO:__main__:Checkpoint saved at row 2649
WARNING:__main__:Missing HTML content for row 2650
WARNING:__main__:Missing HTML content for row 2651
WARNING:__main__:Missing HTML content for row 2652
WARNING:__main__:Missing HTML content for row 2653
WARNING:__main__:Missing HTML content for row 2654
WARNING:__main__:Missing HTML content for row 2655
WARNING:__main__:Missing HTML content for row 2656
WARNING:__main__:Missing HTML content for row 2657
WARNING:__main__:Missing HTML content for row 2658
WARNING:__main__:Missing HTML content for row 2659
INFO:__main__:Progress: 260/31536 (0.8%)
WARNING:__main__:Missing HTML content for row 2410
WARNING:__main__:Missing HTML content for row 2411
WARNING:__main__:Missing HTML content for row 2412
WARNING:__main__:Missing HTML content for row 2413
WARNING:__main__:Missing HTML content for row 2414
WARNING:__main__:Missing HTML content for row 2415
WARNING:__main__:Missing HTML content for row 2416
WARNING:__main__:Missing HTML content for row 2417
WARNING:__main__:Missing HTML content for row 2418
WARNING:__main__:Missing HTML content for row 2419
INFO:__main__:Progress: 270/31536 (0.9%)
Process SpawnPoolWorker-5:
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/opt/anaconda3/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/opt/anaconda3/lib/python3.11/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
                    ^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
           ^^^^^^^^^^^^^^^^
  File "/Volumes/T7/vlm-2/dom_distance_stats.py", line 95, in process_row
    error_msg = f"Error processing row {idx}: {str(e)}"
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Volumes/T7/vlm-2/dom_distance_stats.py", line 66, in compute_tree_edit_distance
    return 100  # Using an arbitrary high value
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/site-packages/zss/compare.py", line 162, in simple_distance
    return distance(
           ^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/site-packages/zss/compare.py", line 294, in distance
    treedist(i, j)
  File "/opt/anaconda3/lib/python3.11/site-packages/zss/compare.py", line 287, in treedist
    partial_ops[x][y] = partial_ops[x][y-1] + [op]
    ~~~~~~~~~~~~~~^^^
KeyboardInterrupt
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.11/multiprocessing/pool.py", line 856, in next
    item = self._items.popleft()
           ^^^^^^^^^^^^^^^^^^^^^
IndexError: pop from an empty deque

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Volumes/T7/vlm-2/dom_distance_stats.py", line 367, in <module>
  File "/Volumes/T7/vlm-2/dom_distance_stats.py", line 233, in calculate_dom_distance_stats
    stats['zero_count'] += 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/multiprocessing/pool.py", line 451, in <genexpr>
    return (item for chunk in result for item in chunk)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/multiprocessing/pool.py", line 861, in next
    self._cond.wait(timeout)
  File "/opt/anaconda3/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt
